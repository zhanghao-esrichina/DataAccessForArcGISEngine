<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="zh-cn">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>HTTP Range - RockyLOMO - åšå®¢å›­</title>
<link type="text/css" rel="stylesheet" href="/bundles/blog-common.css?v=gdNkSiQMyBMkpTeO1ex9qW-60UbMszQItnCUpBAT3LQ1"/>
<link id="MainCss" type="text/css" rel="stylesheet" href="http://common.cnblogs.com/Skins/CornflowerBlue/style.css?id=20140110"/>
<link title="RSS" type="application/rss+xml" rel="alternate" href="http://www.cnblogs.com/Googler/rss"/>
<link title="RSD" type="application/rsd+xml" rel="EditURI" href="http://www.cnblogs.com/Googler/rsd.xml"/>
<link type="application/wlwmanifest+xml" rel="wlwmanifest" href="http://www.cnblogs.com/Googler/wlwmanifest.xml"/>
<script src="http://common.cnblogs.com/script/jquery.js" type="text/javascript"></script>  
<script type="text/javascript">var currentBlogApp = 'Googler', cb_enable_mathjax=false;</script>
<script src="/bundles/blog-common.js?v=VS7ve6HfGvxtuwYyB4SWqTrYP6ZukEwxrePhJmRhqZc1" type="text/javascript"></script>
</head>
<body>
<a name="top"></a>

<div id="top">

<h1><a id="Header1_HeaderTitle" class="headermaintitle" href="http://www.cnblogs.com/Googler/">Googler</a></h1>
<p id="tagline">ä¸“æ³¨Http(s)/DNS Tunnelã€Redis + Hadoop & Distributed crawler.</p>
</div>
<div id="main">
	

	<div class="post">
	
		<h2>
			<a id="cb_post_title_url" href="http://www.cnblogs.com/Googler/archive/2010/08/19/1803700.html">HTTP Range</a>
		</h2>
		<div class="postbody"><div id="cnblogs_post_body"><p>Rangeï¼Œæ˜¯åœ¨ HTTP/1.1ï¼ˆ<a href="http://www.w3.org/Protocols/rfc2616/rfc2616.html">http://www.w3.org/Protocols/rfc2616/rfc2616.html</a>ï¼‰é‡Œæ–°å¢çš„ä¸€ä¸ª header fieldï¼Œä¹Ÿæ˜¯ç°åœ¨ä¼—å¤šå·ç§°å¤šçº¿ç¨‹ä¸‹è½½å·¥å…·ï¼ˆå¦‚ FlashGetã€è¿…é›·ç­‰ï¼‰å®ç°å¤šçº¿ç¨‹ä¸‹è½½çš„æ ¸å¿ƒæ‰€åœ¨ã€‚</p>
<p>Range çš„è§„èŒƒå®šä¹‰å¦‚ä¸‹ï¼š<br />ranges-specifier = byte-ranges-specifier<br />byte-ranges-specifier = bytes-unit &ldquo;=&rdquo; byte-range-set<br />byte-range-set = 1#( byte-range-spec | suffix-byte-range-spec )<br />byte-range-spec = first-byte-pos &ldquo;-&rdquo; [last-byte-pos]<br />first-byte-pos = 1*DIGIT<br />last-byte-pos = 1*DIGIT<br />ï¼ˆRFC2616 é‡Œå……æ–¥ç€è¿™ç§å½¢å¼çš„å®šä¹‰ï¼Œä¸€å¼€å§‹è§‰å¾—æŒºä¹±ï¼Œåæ¥ä¹ æƒ¯äº†å°±å‘ç°å…¶å®æŒºç§‘å­¦ï¼ŒæŒºå¥½ç†è§£çš„:)ï¼‰</p>
<p>å€¼å¾—æ³¨æ„çš„å°±æ˜¯ byte-range-set æ˜¯ä¸€ä¸ª byte-range çš„é›†åˆï¼Œæ‰€ä»¥åœ¨å®é™…è¯·æ±‚ä¸­å®Œå…¨å¯èƒ½ä¼šå‡ºç°å¦‚ä¸‹è¿™ç§å½¢å¼ï¼š<br />Range: bytes=123-567,789-<br />è¿™ä¸ªæ•°æ®åŒºé—´æ˜¯ä¸ªé—­åˆåŒºé—´ï¼Œèµ·å§‹å€¼æ˜¯ 0ï¼Œæ‰€ä»¥&ldquo;Range: bytes=0-1&rdquo;è¿™æ ·ä¸€ä¸ªè¯·æ±‚å®é™…ä¸Šæ˜¯åœ¨è¯·æ±‚å¼€å¤´çš„ 2 ä¸ªå­—èŠ‚ã€‚</p>
<p>byte-range-spec é‡Œçš„ last-byte-pos å¯ä»¥çœç•¥ï¼Œä»£è¡¨ä» first-byte-pos ä¸€ç›´è¯·æ±‚åˆ°ç»“æŸä½ç½®ã€‚å…¶å® first-byte-pos ä¹Ÿæ˜¯å¯ä»¥çœç•¥çš„ï¼Œåªä¸è¿‡å°±ä¸å« byte-range-spec äº†ï¼Œè€Œæ˜¯å« suffix-byte-range-specï¼Œè§„èŒƒå¦‚ä¸‹ï¼š<br />suffix-byte-range-spec = &ldquo;-&rdquo; suffix-length<br />suffix-length = 1*DIGIT<br />æ¯”å¦‚&ldquo;Range: bytes=-200&rdquo;ï¼Œå®ƒä¸æ˜¯è¡¨ç¤ºè¯·æ±‚æ–‡ä»¶å¼€å§‹ä½ç½®çš„ 201 ä¸ªå­—èŠ‚ï¼Œè€Œæ˜¯è¡¨ç¤ºè¦è¯·æ±‚æ–‡ä»¶ç»“å°¾å¤„çš„ 200 ä¸ªå­—èŠ‚ã€‚</p>
<p>å¦‚æœ byte-range-spec çš„ last-byte-pos å°äº first-byte-posï¼Œé‚£ä¹ˆè¿™ä¸ª Range è¯·æ±‚å°±æ˜¯æ— æ•ˆè¯·æ±‚ï¼Œserver éœ€è¦å¿½ç•¥è¿™ä¸ª Range è¯·æ±‚ï¼Œç„¶åå›åº”ä¸€ä¸ª 200 OKï¼ŒæŠŠæ•´ä¸ªæ–‡ä»¶å‘ç»™ clientã€‚<br />å¦‚æœ byte-range-spec é‡Œçš„ first-byte-pos å¤§äºæ–‡ä»¶é•¿åº¦ï¼Œæˆ–è€… suffix-byte-range-spec é‡Œçš„ suffix-length ç­‰äº 0ï¼Œé‚£ä¹ˆè¿™ä¸ª Range è¯·æ±‚è¢«è®¤ä¸ºæ˜¯ä¸èƒ½æ»¡è¶³çš„ï¼Œserver éœ€è¦å›åº”ä¸€ä¸ª 416 Requested range not satisfiableã€‚</p>
<p>server é™¤äº†è¦èƒ½ç†è§£ Rä¸ªå­—èŠ‚ã€‚</p>
<p>byte-range-spec é‡Œçš„ last-byte-pos å¯ä»¥çœç•¥ï¼Œä»£è¡¨ä» first-byte-pos ä¸€ç›´è¯·æ±‚åˆ°ç»“æŸä½ç½®ã€‚å…¶å® first-byte-pos ä¹Ÿæ˜¯å¯ä»¥çœç•¥çš„ï¼Œåªä¸è¿‡å°±ä¸å« byte-range-spec äº†ï¼Œè€Œæ˜¯å« suffix-byte-range-specï¼Œè§„èŒƒå¦‚ä¸‹ï¼š<br />suffix-byte-range-spec = &ldquo;-&rdquo; suffix-length<br />suffix-length = 1*DIGIT<br />æ¯”åange è¯·æ±‚ä¹‹å¤–ï¼Œåœ¨å›åº” client æ—¶è¿˜è¦ä½¿ç”¨ Content-Range æ¥å‘Šè¯‰ client ä»–åˆ°åº•å‘é€äº†å¤šå°‘æ•°æ®ï¼ŒContent-Range çš„è§„èŒƒå®šä¹‰å¦‚ä¸‹ï¼š<br />Content-Range = &ldquo;Content-Range&rdquo; &ldquo;:&rdquo; content-range-spec<br />content-range-spec = byte-content-range-spec<br />byte-content-range-spec = bytes-unit SP byte-range-resp-spec &ldquo;/&rdquo; ( instance-length | &ldquo;*&rdquo; )<br />byte-range-resp-spec = (first-byte-pos &ldquo;-&rdquo; last-byte-pos) | &ldquo;*&rdquo;<br />instance-length = 1*DIGIT</p>
<p>è¯¦å°½çš„ç»†ææœ«èŠ‚å°±ä¸åœ¨è¿™é‡Œè®°è¿°äº†ï¼Œä¸¾ä¸ªä¾‹å­è¯´æ˜ä¸€ä¸‹ï¼Œæ¯”å¦‚æŸæ–‡ä»¶çš„å¤§å°æ˜¯ 1000 å­—èŠ‚ï¼Œclient è¯·æ±‚è¿™ä¸ªæ–‡ä»¶æ—¶ç”¨äº† &ldquo;Range: bytes=0-500&rdquo;ï¼Œé‚£ä¹ˆ server åº”è¯¥æŠŠè¿™ä¸ªæ–‡ä»¶å¼€å¤´çš„ 501 ä¸ªå­—èŠ‚å‘å›ç»™ clientï¼ŒåŒæ—¶å›åº”å¤´è¦æœ‰å¦‚ä¸‹å†…å®¹ï¼š<br />Content-Range: bytes 0-500/1000</p>
<p>Range è¯·æ±‚çš„ä¸€äº›æ³¨æ„äº‹é¡¹ï¼š<br />1) ä¸æ”¯æŒ Range è¯·æ±‚çš„ server è¦ç”¨&ldquo;Accept-Ranges: none&rdquo;å¯¹ client è¡¨æ˜å¿ƒæ„ï¼›server ä¹Ÿå¯ä»¥ä¸»åŠ¨å‘Šè¯‰ client &ldquo;Accept-Ranges: bytes&rdquo;ï¼Œä½†æ˜¯ client ä¹Ÿå¯ä»¥åœ¨æ²¡æœ‰æ”¶åˆ°è¿™ä¸ªæŒ‡ç¤ºçš„å‰æä¸‹å‘ server å‘ Range è¯·æ±‚ã€‚<br />2) byte-range-set ä¸­çš„åŒºé—´å¯ä»¥æ˜¯&ldquo;æœ‰æ´&rdquo;çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯éƒ¨åˆ†é‡å çš„<br />3) å•åŒºé—´çš„ byte-range-set æ­£å¸¸å›åº”å°±å¯ä»¥äº†ï¼Œä½†æ˜¯å¤šåŒºé—´ byte-range-set éœ€è¦ server ä½¿ç”¨ multipart/byterange æ¥å›åº”</p>
<p>Rangeå¤´åŸŸ&nbsp;&nbsp;<br />ã€€ã€€Rangeå¤´åŸŸå¯ä»¥è¯·æ±‚å®ä½“çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªå­èŒƒå›´ã€‚ä¾‹å¦‚ï¼Œ&nbsp;&nbsp;<br />ã€€ã€€è¡¨ç¤ºå¤´500ä¸ªå­—èŠ‚ï¼šbytes=0-499&nbsp;&nbsp;<br />ã€€ã€€è¡¨ç¤ºç¬¬äºŒä¸ª500å­—èŠ‚ï¼šbytes=500-999&nbsp;&nbsp;<br />ã€€ã€€è¡¨ç¤ºæœ€å500ä¸ªå­—èŠ‚ï¼šbytes=-500&nbsp;&nbsp;<br />ã€€ã€€è¡¨ç¤º500å­—èŠ‚ä»¥åçš„èŒƒå›´ï¼šbytes=500-&nbsp;&nbsp;<br />ã€€ã€€ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªå­—èŠ‚ï¼šbytes=0-0,-1&nbsp;&nbsp;<br />ã€€ã€€åŒæ—¶æŒ‡å®šå‡ ä¸ªèŒƒå›´ï¼šbytes=500-600,601-999&nbsp;</p></div><div id="MySignature"></div>
<div class="clear"></div>
<div id="blog_post_info_block">
<div id="blog_post_info">
</div>
<div class="clear"></div>
<div id="post_next_prev"></div>
</div>

</div>
		<p class="postfoot">
			posted on <span id="post-date">2010-08-19 16:58</span> <a href='http://www.cnblogs.com/Googler/'>RockyLOMO</a> é˜…è¯»(<span id="post_view_count">...</span>) è¯„è®º(<span id="post_comment_count">...</span>)  <a href ="http://www.cnblogs.com/Googler/admin/EditPosts.aspx?postid=1803700" rel="nofollow">ç¼–è¾‘</a> <a href="#" onclick="AddToWz(1803700);return false;">æ”¶è—</a>
		</p>
	</div>
	<script type="text/javascript">var allowComments=true,isLogined=false,cb_blogId=71506,cb_entryId=1803700,cb_blogApp=currentBlogApp,cb_blogUserGuid='9c3219b1-0012-df11-ba8f-001cf0cd104b',cb_entryCreatedDate='2010/8/19 16:58:00';loadViewCount(cb_entryId);</script>
	
<a name="!comments"></a><div id="blog-comments-placeholder"></div><script type="text/javascript">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>
<div id="comment_form" class="commentform">
<a name="commentform"></a>
<div id="divCommentShow"></div>
<div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);" id="lnk_RefreshComments" onclick="return RefreshCommentList();">åˆ·æ–°è¯„è®º</a><a href="#" onclick="return RefreshPage();">åˆ·æ–°é¡µé¢</a><a href="#top">è¿”å›é¡¶éƒ¨</a></div>
<div id="comment_form_container"></div>
<div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
<div id="site_nav_under"><a href="http://www.cnblogs.com/" target="_blank" title="ç¨‹åºå‘˜çš„ç½‘ä¸Šå®¶å›­">åšå®¢å›­é¦–é¡µ</a><a href="http://q.cnblogs.com/" target="_blank" title="ç¨‹åºå‘˜é—®ç­”ç¤¾åŒº">åšé—®</a><a href="http://news.cnblogs.com/" target="_blank" title="ITæ–°é—»">æ–°é—»</a><a href="http://home.cnblogs.com/ing/" target="_blank">é—ªå­˜</a><a href="http://job.cnblogs.com/" target="_blank">ç¨‹åºå‘˜æ‹›è˜</a><a href="http://kb.cnblogs.com/" target="_blank">çŸ¥è¯†åº“</a></div>
<div id="ad_under_post_holder"></div>
<script type="text/javascript">
var enableGoogleAd = true;
var googletag = googletag || {};
googletag.cmd = googletag.cmd || [];
fixPostBodyFormat();
loadAdUnderPost();
</script>
<div id="HistoryToday" class="c_ad_block"></div>
<script type="text/javascript">
loadBlogSignature();
LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);
GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);
</script>
<script type="text/javascript">
    $.ajax({ url: 'http://counter.cnblogs.com/blog/post/' + cb_entryId, type: 'get', dataType: 'script', cache: true });
</script>
</div>

</div>
<div id="rightmenu">

	
<h3>My Links</h3>
<ul>
			<li><a id="MyLinks1_HomeLink" href="http://www.cnblogs.com/">åšå®¢å›­</a></li>
			<li><a id="MyLinks1_MyHomeLink" href="http://www.cnblogs.com/Googler/">é¦–é¡µ</a></li>
			<li><a id="MyLinks1_NewPostLink" rel="nofollow" href="http://www.cnblogs.com/Googler/admin/EditPosts.aspx?opt=1">æ–°éšç¬”</a></li>
			<li><a id="MyLinks1_ContactLink" accesskey="9" rel="nofollow" href="http://space.cnblogs.com/msg/send/RockyLOMO">è”ç³»</a></li>
			<li><a id="MyLinks1_Syndication" href="http://www.cnblogs.com/Googler/rss">è®¢é˜…</a> <a id="MyLinks1_XMLLink" href="http://www.cnblogs.com/Googler/rss"><img src="http://www.cnblogs.com/images/xml.gif" alt="è®¢é˜…" /></a>
			<li><a id="MyLinks1_Admin" rel="nofollow" href="http://www.cnblogs.com/Googler/admin/EditPosts.aspx">ç®¡ç†</a></li>
</ul>
	
<h3>Blog Stats</h3>
	<ul>
		<li>éšç¬” - 136
		<li>æ–‡ç«  - 0
		<li>è¯„è®º - 16
		<li>Trackbacks - 0
	</li>
</ul>
	
<h3>News</h3>
	<ul>
	  <li><div id="blog-news"></div><script type="text/javascript">loadBlogNews();</script></li>
	</ul>

	<div id="blog-sidecolumn"></div><script type="text/javascript">loadBlogSideColumn();</script>

</div>


<p id="footer">
	Powered by: 
	<br />
	
	<a id="Footer1_Hyperlink3" NAME="Hyperlink1" href="http://www.cnblogs.com/"><font face="Verdana">åšå®¢å›­</font></a>
	<br />
	Copyright &copy; RockyLOMO
</p>
<!--PageEndHtml Block Begin-->
<a href="http://s.click.taobao.com/t?e=zGU34CA7K%2BPkqB07S4%2FK0CITy7klxxrJ35Nnc0iLIMRuMWxqH%2BV1EzTTOR%2F6rhHHEqzwxuDCnYWtqQ9fejMt9MZ3OqqYs%2BlVkZxznEDGX%2BzqfA%3D%3D">Apple/è‹¹æœç¬”è®°æœ¬ Mac Air MC968CH/A è¡Œè´§åœ¨ä¿ I5 11å¯¸ è¶…çº§æœ¬</a>
<!--PageEndHtml Block End-->
</body>
</html>
			<li><a id="MyLinks1_Admin" rel="nofollow" href="http://www.cnblogs.com/Googler/admin/EditPosts.aspx">ç®¡ç†</a></li>
</ul>
	
<h3>Blog Stats</h3>
	<ul>
		<li>éšç¬” - 136
		<li>æ–‡ç«  - 0
		<li>è¯„è®º - 16
		<li>Trackbacks - 0
	</li>
</ul>
	
<h3>News</h3>
	<ul>
	  <li><div id="blog-news"></div><script type="text/javascript">loadBlogNews();</script></li>
	</ul>

	<div id="blog-sidecolumn"></div><script type="text/javascript">loadBlogSideColumn();</script>

</div>


<p id="footer">
	Powered by: 
	<br />
	
	<a id="Footer1_Hyperlink3" NAME="Hyperlink1" href="http://www.cnblogs.com/"><font face="Verdana">åšå®¢å›­</font></a>
	<br />
	Copyright &co